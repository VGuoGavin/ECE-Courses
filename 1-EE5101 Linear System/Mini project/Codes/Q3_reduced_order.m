clc
clear
close all

a = 0;  b = 0;  c = 1;  d = 4;

A = [ -8.8487+(a-b)/5,           -0.0399,                     -5.55+(c+d)/10,               3.5846;
        -4.574                             2.501*(d+5)/(c+5),   -4.3662,                           -1.1183-(a-c)/20 ;
        3.7698,                          16.1212-c/5,               -18.2103 + (a+d)/(b+4),  4.4936;
      -8.5645-(a-b)/(c+d+2),  8.3742,                       -4.4331 ,                          -7.7181*(c+5)/(b+5) ];

B = [0.0564+b/(10+c),                       0.0319;
        0.0165-(c+d-5)/(1000+20*a),   -0.02;
       4.4939,                                       1.5985*(a+10)/(b+12);
      -1.4269,                                     -0.273 ];

C = [-3.2988,              -2.1932+(10*c+d)/(100+5*a),  0.037,      -0.0109;
    0.2922-a*b/500,    -2.1506,                                      -0.0104,    0.0163];

syms t1 t2 t3 t4 t5 t6 t7 t8 
T = [t1 t2 t3 t4;
      t5 t6 t7 t8];
D = [-5 0;
        0 -8];
g1 = 1;
g2 = 2;
G = [g1 0;
        0 g2];

equ = D * T - T*A + G*C == 0;
T_res = solve(equ);
T(1,1) = T_res.t1;
T(1,2) = T_res.t2;
T(1,3) = T_res.t3;
T(1,4) = T_res.t4;
T(2,1) = T_res.t5;
T(2,2) = T_res.t6;
T(2,3) = T_res.t7;
T(2,4) = T_res.t8;
T = double(T);
E = double(T*B);
% C_new = inv([C;T]);
T_new = inv([C; T]);
